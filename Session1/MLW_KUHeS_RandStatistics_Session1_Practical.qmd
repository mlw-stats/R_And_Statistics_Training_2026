---
title: "MLW / KUHeS Statistics and R short course"
subtitle: "Session 1 - Practical"
author: "Evaristar Kudowa, Marc Henrion"
date: "19 January 2026"
format:
  pdf:
    fig-width: 16
    fig-height: 9
toc: false
---

```{r setup}
#| include: false
#| echo: false

require(tidyverse)
require(knitr)
require(gridExtra)
require(kableExtra)
```


# Session 1 - Practical (Solutions)

Go to the course website on GitHub:

[https://github.com/mlw-stats/R_And_Statistics_Training_2026/Session1](https://github.com/mlw-stats/R_And_Statistics_Training_2026/Session1)

From here, in the **dataAndSupportDocs** folder, download the following files:

    btTBreg.csv
    btTBregHospitals.csv
    btTBreg_info.txt

1. Load the `btTBreg.csv` data table into R.

2. The variables `cd41`, `cd42` and `cd41.sk`, `cd42.sk` measure the same variables (`cd4` and `cd4.sk` respectively) in the same individuals at two different time point. This means the data are in wide format. Reformat to long format.

3. Save the reformatted data into a file called `btTBregLong.tab` in such a way that
    i. Columns are tab-separated.
    ii. Column names are saved.
    iii. No row number is saved in the resulting file.
  
4. Copy the code below to generate some wide-format data. We will assume this dataset contains observations of 2 biomarkers, `ferritin` and `rbp4` for 10 study participants at 2 different timepoints, `day1` and `day90`.

```{r}
set.seed(123)

df<-data.frame(
  id=paste(sep="","P",1:10),
  ferritin_day1=rexp(10,rate=1/195),
  rbp4_day1=rexp(10,rate=1/2.5)
) %>%
  mutate(
    ferritin_day90=rnorm(10,mean=ferritin_day1+5,sd=4),
    rbp4_day90=rbp4_day1+rexp(10,rate=1/0.25)
  )
```

This is what this data table looks like:

```{r, echo=FALSE}
print(df)
```

Reformat this to long format, i.e. so that you have 4 columns: `id`, `time`, `ferritin` and `rbp4`.

5. Load the `btTBregHospitals.csv` data table. Join the data frames storing `btTBreg.csv` and `btTBregHospitals.csv`.

6. Compute the average patient age and the proportion of male patients for each hospital.

Useful functions for this are `aggregate()` and `group_by()`. You can however also do it manually.

7. Write an R function that computes the following summary statistics, then, using your custom function, compute these for the `bmi`, `cd41`, `cd42` columns:
    i. mean
    ii. median
    iii. interquartile range
    iv. minimum
    v. maximum
    vi. number of missing values
    
8. Do the same now, but only for female patients. Repeat for only male patients.
